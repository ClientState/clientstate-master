nginx:
  # volumes with vagrant are wtf.
  # so, we add the confs in the dockerfile
  environment:
    CSM_SERVER_NAME:
  build: ./docker/nginx/
  ports:
    - "80:80"
    - "443:443"
  links:
    - csm

csm:
  build: .
  environment:
    GITHUB_CLIENT_ID:
    GITHUB_CLIENT_SECRET:
    OAUTH_REDIRECT_URL:
    PG_USER: postgres
    # access docker with
    # DOCKER_PARENT_HOST
    # and DOCKER_PARENT_PORT
  command: node server.js
  ports:
    - "4000:4000"
  links:
    - pg

pg:
  image: postgres
